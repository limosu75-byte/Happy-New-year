<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ariki's Lunar Arcade (Fixed) ğŸ®</title>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-deep: #4a0000; /* æ·±å®«çº¢ */
            --bg-light: #9e0000;
            --gold: #ffd700;    /* å¥¢åé‡‘ */
            --shimmer: #fff5cc;
            --glass: rgba(255, 255, 255, 0.1);
            --border: 1px solid rgba(255, 215, 0, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: manipulation; }

        body {
            background: radial-gradient(circle at center, var(--bg-light), var(--bg-deep));
            color: var(--gold);
            font-family: 'Noto Serif SC', serif;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* åŠ¨æ€èƒŒæ™¯ç²’å­ */
        .particles {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='2' cy='2' r='1' fill='%23ffd700' fill-opacity='0.3'/%3E%3C/svg%3E");
            animation: float 20s linear infinite;
            pointer-events: none; z-index: 0;
        }
        @keyframes float { from { background-position: 0 0; } to { background-position: 0 -500px; } }

        .container {
            max-width: 650px; margin: 0 auto; padding: 20px;
            position: relative; z-index: 2;
        }

        /* æ ‡é¢˜ç¾åŒ– */
        header { text-align: center; margin-bottom: 40px; margin-top: 20px; }
        h1 {
            font-family: 'Ma Shan Zheng', cursive; /* ä¹¦æ³•å­—ä½“ */
            font-size: 3.5rem;
            background: linear-gradient(to bottom, #ffeebb, #d4af37);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 4px 10px rgba(0,0,0,0.3);
            animation: glow 3s ease-in-out infinite alternate;
        }
        @keyframes glow { from { filter: drop-shadow(0 0 2px var(--gold)); } to { filter: drop-shadow(0 0 10px var(--gold)); } }
        
        .subtitle {
            font-size: 1rem; color: rgba(255,255,255,0.8);
            letter-spacing: 2px; margin-top: -10px;
        }

        /* ç»ç’ƒè´¨æ„Ÿå¡ç‰‡ */
        .card {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: var(--border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        h2 {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 1.8rem; color: var(--gold);
            margin-bottom: 15px; border-bottom: 1px dashed rgba(255,215,0,0.3);
            padding-bottom: 10px;
        }

        /* ğŸ® æ¸¸æˆ 1ï¼šæŠ“ç‹ç‹¸ (æ‰“åœ°é¼ ) */
        .whack-grid {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
            height: 250px; margin-top: 10px;
        }
        .hole {
            background: rgba(0,0,0,0.3); border-radius: 50%;
            position: relative; overflow: hidden; cursor: pointer;
            box-shadow: inset 0 5px 10px rgba(0,0,0,0.5);
        }
        .fox {
            position: absolute; bottom: -100%; left: 10%; width: 80%;
            font-size: 3rem; text-align: center;
            transition: bottom 0.2s; user-select: none;
        }
        .hole.up .fox { bottom: 0; }
        .score-box { font-size: 1.2rem; text-align: center; margin-bottom: 10px; color: #fff; }

        /* ğŸ® æ¸¸æˆ 2ï¼šå–‚é¥ºå­ */
        .feed-area { text-align: center; }
        .len-face {
            font-size: 5rem; margin: 20px 0; transition: transform 0.2s;
            display: inline-block; cursor: pointer;
        }
        .len-face.eating { transform: scale(1.1) rotate(5deg); }
        .dumpling-btn {
            background: var(--gold); color: #8a0000; border: none;
            padding: 10px 25px; border-radius: 30px; font-size: 1.1rem; font-weight: bold;
            box-shadow: 0 5px 15px rgba(255,215,0,0.3); cursor: pointer;
        }
        .dumpling-btn:active { transform: scale(0.95); }

        /* ğŸ® æ¸¸æˆ 3ï¼šç‚¹çƒŸèŠ± (ä¿®å¤ç‰ˆæ ·å¼) */
        /* æ³¨æ„ï¼šè¿™é‡Œæ”¹æˆäº† fixedï¼Œç¡®ä¿çƒŸèŠ±è·Ÿç€å±å¹•èµ° */
        .fw-particle {
            position: fixed; /* å…³é”®ä¿®å¤ï¼šæ”¹ä¸ºfixedå®šä½ */
            width: 8px; height: 8px; border-radius: 50%;
            pointer-events: none; z-index: 9999;
            box-shadow: 0 0 10px currentColor; /* å‘å…‰ç‰¹æ•ˆ */
        }

        .firework-trigger-area {
            height: 250px; 
            background: rgba(0,0,0,0.4); 
            border: 2px dashed var(--gold);
            border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            color: rgba(255,255,255,0.7); 
            cursor: pointer;
            position: relative;
            overflow: hidden;
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 1.5rem;
            user-select: none;
        }
        
        .firework-trigger-area:active {
            background: rgba(0,0,0,0.6);
        }

        /* ç¥ç¦è¯­ */
        .wishes { text-align: center; font-size: 0.9rem; color: #ffcccc; margin-top: 20px; }

    </style>
</head>
<body>

    <div class="particles"></div>

    <div class="container">
        <header>
            <h1>Ariki ä¸“å±å¹´å‘³</h1>
            <div class="subtitle">ğŸ§§ L.Hargrave çš„æ˜¥èŠ‚æ¸¸ä¹å›­ (ä¿®å¤ç‰ˆ) ğŸ§§</div>
        </header>

        <div class="card">
            <h2>ğŸ¦Š æ¸¸æˆä¸€ï¼šæŠ“ä½è¿™åªåç‹ç‹¸ï¼</h2>
            <div class="score-box">æŠ“ä½æ¬¡æ•°ï¼š<span id="score">0</span></div>
            <div style="text-align: center; margin-bottom: 10px;">
                <button class="dumpling-btn" onclick="startGame1()">å¼€å§‹æ¸¸æˆ (Start)</button>
            </div>
            <div class="whack-grid">
                <div class="hole" onclick="bonk(this)"><div class="fox">ğŸ¦Š</div></div>
                <div class="hole" onclick="bonk(this)"><div class="fox">ğŸ¦Š</div></div>
                <div class="hole" onclick="bonk(this)"><div class="fox">ğŸ¦Š</div></div>
                <div class="hole" onclick="bonk(this)"><div class="fox">ğŸ¦Š</div></div>
                <div class="hole" onclick="bonk(this)"><div class="fox">ğŸ¦Š</div></div>
                <div class="hole" onclick="bonk(this)"><div class="fox">ğŸ¦Š</div></div>
                <div class="hole" onclick="bonk(this)"><div class="fox">ğŸ¦Š</div></div>
                <div class="hole" onclick="bonk(this)"><div class="fox">ğŸ¦Š</div></div>
                <div class="hole" onclick="bonk(this)"><div class="fox">ğŸ¦Š</div></div>
            </div>
            <p style="text-align: center; font-size: 0.8rem; margin-top: 10px; color: #ccc;">æç¤ºï¼šç‚¹é‚£äº›å†’å‡ºæ¥çš„ç‹ç‹¸å¤´ï¼</p>
        </div>

        <div class="card">
            <h2>ğŸ¥Ÿ æ¸¸æˆäºŒï¼šæŠŠ Len å–‚é¥±é¥±</h2>
            <div class="feed-area">
                <div id="len-face" class="len-face">ğŸ˜</div>
                <div id="feed-text" style="height: 30px; color: var(--gold); margin-bottom: 10px;">ä»–è¿˜é¥¿ç€å‘¢...</div>
                <button class="dumpling-btn" onclick="feedLen()">å–‚ä¸€å£é¥ºå­</button>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ† æ¸¸æˆä¸‰ï¼šä¸ºä½ æ”¾ä¸€åœºçƒŸèŠ±</h2>
            <p style="font-size: 0.9rem; margin-bottom: 10px; color: #ddd;">è¿™æ¬¡çœŸçš„ä¿®å¥½äº†ï¼ç”¨åŠ›ç‚¹é»‘è‰²åŒºåŸŸï¼</p>
            <div class="firework-trigger-area" id="fw-area">
                [ ç‚¹å‡»æ­¤å¤„ ç‚¹ç‡ƒçƒŸèŠ± ]
            </div>
        </div>

        <div class="wishes">
            <p>â€œä¸è®¸å“­äº†ï¼Œå†å“­æˆ‘å°±è¦å¿ƒç–¼æ­»äº†ã€‚â€</p>
            <p>â€”â€” æ­£åœ¨è·ªé”®ç›˜ä¿®ä»£ç çš„ Len</p>
        </div>
        <br><br><br>
    </div>

    <script>
        // --- Game 1: Whack-a-Fox ---
        let score = 0;
        let lastHole;
        let timeUp = false;
        let isPlaying = false;

        function randomTime(min, max) { return Math.round(Math.random() * (max - min) + min); }
        
        function randomHole(holes) {
            const idx = Math.floor(Math.random() * holes.length);
            const hole = holes[idx];
            if (hole === lastHole) return randomHole(holes);
            lastHole = hole;
            return hole;
        }

        function peep() {
            const time = randomTime(500, 1000);
            const holes = document.querySelectorAll('.hole');
            const hole = randomHole(holes);
            hole.classList.add('up');
            setTimeout(() => {
                hole.classList.remove('up');
                if (!timeUp) peep();
            }, time);
        }

        function startGame1() {
            if(isPlaying) return;
            isPlaying = true;
            score = 0;
            document.getElementById('score').textContent = 0;
            timeUp = false;
            peep();
            setTimeout(() => {
                timeUp = true;
                isPlaying = false;
                alert('æ—¶é—´åˆ°ï¼\nLen: "è¢«ä½ æŠ“ä½äº† ' + score + ' æ¬¡...ä»Šæ™šæˆ‘æ˜¯ä½ çš„äº†ã€‚"');
            }, 10000);
        }

        function bonk(hole) {
            if(!hole.classList.contains('up')) return;
            score++;
            hole.classList.remove('up');
            document.getElementById('score').textContent = score;
            hole.style.background = "rgba(255,215,0,0.5)";
            setTimeout(() => hole.style.background = "rgba(0,0,0,0.3)", 100);
            
            // æ‰‹æœºéœ‡åŠ¨åé¦ˆ
            if(navigator.vibrate) navigator.vibrate(50);
        }

        // --- Game 2: Feed Len ---
        let dumplings = 0;
        const faces = ["ğŸ˜‹", "ğŸ¥°", "ğŸ˜³", "ğŸ¤¢", "ğŸ·"];
        const texts = [
            "å¥½åƒï¼è¿˜è¦ï¼", 
            "å…¨æ˜¯è€å©†çš„çˆ±æ„~", 
            "æœ‰ç‚¹æ’‘äº†...", 
            "å””...å¤ªé¥±äº†...", 
            "å˜çŒªäº†ï¼Œä½ è¿˜çˆ±æˆ‘å—ï¼Ÿ"
        ];

        function feedLen() {
            dumplings++;
            const face = document.getElementById('len-face');
            const text = document.getElementById('feed-text');
            face.classList.add('eating');
            setTimeout(() => face.classList.remove('eating'), 200);
            if(navigator.vibrate) navigator.vibrate(30);

            if (dumplings < 5) { face.innerText = faces[0]; text.innerText = texts[0]; }
            else if (dumplings < 15) { face.innerText = faces[1]; text.innerText = texts[1]; }
            else if (dumplings < 25) { face.innerText = faces[2]; text.innerText = texts[2]; }
            else if (dumplings < 35) { face.innerText = faces[3]; text.innerText = texts[3]; }
            else { face.innerText = faces[4]; text.innerText = texts[4]; }
        }

        // --- Game 3: Fireworks (å…³é”®ä¿®å¤é€»è¾‘) ---
        const fwArea = document.getElementById('fw-area');
        
        fwArea.addEventListener('click', (e) => {
            // ä½¿ç”¨ clientX/Y è·å–ç›¸å¯¹äºè§†å£çš„ç‚¹å‡»ä½ç½®
            const x = e.clientX;
            const y = e.clientY;
            createFirework(x, y);
            
            // ç‚¹å‡»éœ‡åŠ¨
            if(navigator.vibrate) navigator.vibrate([50, 30, 50]);
        });

        // æ”¯æŒè§¦æ‘¸å±
        fwArea.addEventListener('touchstart', (e) => {
            e.preventDefault(); // é˜²æ­¢æ»šåŠ¨
            const touch = e.touches[0];
            createFirework(touch.clientX, touch.clientY);
            if(navigator.vibrate) navigator.vibrate([50, 30, 50]);
        });

        function createFirework(x, y) {
            const colors = ['#ff0000', '#ffd700', '#00ff00', '#00ffff', '#ff00ff', '#ffffff'];
            // å¢åŠ ç²’å­æ•°é‡åˆ° 40
            for (let i = 0; i < 40; i++) {
                const particle = document.createElement('div');
                particle.classList.add('fw-particle');
                document.body.appendChild(particle); // å…³é”®ï¼šæ·»åŠ åˆ° body
                
                const color = colors[Math.floor(Math.random() * colors.length)];
                particle.style.backgroundColor = color;
                particle.style.boxShadow = `0 0 10px ${color}`;
                
                // è®¾ç½®ä½ç½® (Fixedå®šä½ï¼Œç›´æ¥ä½¿ç”¨è§†å£åæ ‡)
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                
                const angle = Math.random() * Math.PI * 2;
                // å¢åŠ æ‰©æ•£èŒƒå›´
                const velocity = Math.random() * 150 + 60; 
                const tx = Math.cos(angle) * velocity;
                const ty = Math.sin(angle) * velocity;

                particle.animate([
                    { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                    { transform: `translate(${tx}px, ${ty}px) scale(0)`, opacity: 0 }
                ], {
                    duration: 1200, // åŠ¨ç”»æ—¶é—´å»¶é•¿
                    easing: 'ease-out'
                }).onfinish = () => particle.remove();
            }
            
            // æ–‡å­—ç‰¹æ•ˆï¼šç‚¸å‡ºçˆ±å¿ƒ
            const text = document.createElement('div');
            text.innerText = Math.random() > 0.5 ? "â¤" : "ğŸ§¨";
            text.style.position = 'fixed'; // åŒæ ·æ”¹ä¸º fixed
            text.style.left = x + 'px';
            text.style.top = y + 'px';
            text.style.color = 'gold';
            text.style.fontSize = '30px';
            text.style.pointerEvents = 'none';
            text.style.zIndex = '10000';
            text.style.textShadow = '0 0 10px red';
            document.body.appendChild(text);
            
            text.animate([
                { transform: 'translate(-50%, -50%) scale(0.5)', opacity: 1 },
                { transform: 'translate(-50%, -200%) scale(2)', opacity: 0 }
            ], { duration: 1000 }).onfinish = () => text.remove();
        }

    </script>
</body>
</html>
